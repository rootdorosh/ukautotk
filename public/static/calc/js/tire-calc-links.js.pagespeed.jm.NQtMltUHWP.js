(function(){var CalcLinksKeeper=function(){this.rowSelector='table.cf tbody tr';this.oemRowClass='stock';this.oemRowSelector=this.rowSelector+'.'+this.oemRowClass;this.linkClass='tire-calc-link';this.activeLinkClass='active';this.oemLinkClass='oem';this.calcLinkSelector=this.rowSelector+' .'+this.linkClass;this.currentOem=$();this.initLinks();this.bindEvents();};CalcLinksKeeper.prototype={initLinks:function(){var self=this;},renewLinkUrl:function(){var $link=this.currentOem.find('a.link');var activeLinks=$(this.rowSelector+' .'+this.activeLinkClass);var params={wheel1:this.currentOem.data('wheel')};activeLinks.not(this.currentOem).each(function(index){params['wheel'+(index+2)]=$(this).data('wheel');});$link.attr('href',$link.data('href')+'?'+$.param(params));},isActive:function($calcLink){return $calcLink.hasClass(this.activeLinkClass);},toggleActive:function($calcLink){$calcLink.toggleClass(this.activeLinkClass);},thereIsNoOem:function(){return this.currentOem.size()===0;},isOem:function($calcLink){return $calcLink.hasClass(this.oemLinkClass);},markAsOem:function($calcLink){this.unmarkOem(this.currentOem);$calcLink.addClass(this.oemLinkClass);var oemLink=$calcLink.find('a.oem');oemLink.attr('title',oemLink.data('activeTitle'));this.currentOem=$calcLink;},unmarkOem:function($calcLink){$calcLink.removeClass(this.oemLinkClass);var oemLink=$calcLink.find('a.oem');oemLink.attr('title',oemLink.data('title'));},markFirstActiveOem:function(){var firstActiveOem=$(this.oemRowSelector+' .'+this.activeLinkClass).first();this.markAsOem(firstActiveOem);},markLink:function($calcLink){this.toggleActive($calcLink);if(this.isActive($calcLink)&&this.thereIsNoOem()){this.markAsOem($calcLink);}else if(!this.isActive($calcLink)&&this.isOem($calcLink)){this.markFirstActiveOem();}},bindEvents:function(){var self=this;$(this.calcLinkSelector+' a.mark').on('click',function(e){e.preventDefault();self.markLink($(this).parent());self.renewLinkUrl();});$(this.calcLinkSelector+' a.oem').on('click',function(e){e.preventDefault();self.markAsOem($(this).parent());self.renewLinkUrl();});}};$(document).ready(function(){new CalcLinksKeeper();});})();